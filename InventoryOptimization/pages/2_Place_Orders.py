import streamlit as st
import pandas as pd
from data import پیشنهادات_سفارش, df, بروزرسانی_موجودی

st.set_page_config(page_title="مدیریت سفارشات")

st.title("🛒 مدیریت سفارشات موجودی")

سفارشات_پیشنهادی = پیشنهادات_سفارش()

st.subheader("📌 پیشنهادات سفارش برای تکمیل کالاهای کم‌موجودی")

if not سفارشات_پیشنهادی.empty:
    st.warning("برخی از محصولات نیاز به سفارش مجدد دارند. لطفاً سفارش دهید!")
    st.dataframe(سفارشات_پیشنهادی)
else:
    st.success("✅ در حال حاضر نیازی به سفارش مجدد نیست.")

# فرم ثبت سفارش
st.subheader("📦 ثبت سفارش جدید")

انتخاب_محصول = st.selectbox("انتخاب محصول", df["محصول"].tolist())
تعداد_سفارش = st.number_input("تعداد سفارش", min_value=1, value=10)

if st.button("ثبت سفارش"):
    بروزرسانی_موجودی(انتخاب_محصول, تعداد_سفارش)  # افزودن به موجودی انبار
    st.success(f"📦 {تعداد_سفارش} عدد از {انتخاب_محصول} به انبار اضافه شد!")
    st.rerun()  # اصلاح‌شده
