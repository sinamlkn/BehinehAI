import streamlit as st
import pandas as pd
import plotly.express as px
from data import df, ุจุฑูุฒุฑุณุงู_ููุฌูุฏ

st.set_page_config(page_title="ุฏุงุดุจูุฑุฏ ููุฌูุฏ", layout="wide")

st.title("๐ฆ ุฏุงุดุจูุฑุฏ ูุฏุฑุช ููุฌูุฏ")

# ุฌุณุชุฌู
ุฌุณุชุฌู = st.text_input("๐ ุฌุณุชุฌู ุฏุฑ ููุฌูุฏ (ุจุฑ ุงุณุงุณ ูุงู ูุญุตูู ุง ฺฉุฏ ฺฉุงูุง)", "")

# ููุชุฑ ุจุฑ ุงุณุงุณ ุฌุณุชุฌู
ููุชุฑ_ุดุฏู = df[df["ูุญุตูู"].str.contains(ุฌุณุชุฌู, case=False) | df["ฺฉุฏ ฺฉุงูุง"].str.contains(ุฌุณุชุฌู, case=False)]

st.subheader("๐ ูุถุนุช ููุฌูุฏ")
st.dataframe(ููุชุฑ_ุดุฏู)

# ูููุฏุงุฑ ุฑููุฏ ููุฌูุฏ
st.subheader("๐ ูููุฏุงุฑ ููุฌูุฏ")
fig = px.bar(ููุชุฑ_ุดุฏู, x="ูุญุตูู", y=["ููุฌูุฏ", "ููุฌูุฏ ูพุดโุจูโุดุฏู", "ุญุฏุงูู ููุฌูุฏ"], barmode="group")
st.plotly_chart(fig)

# ูุฑุงุด ููุฌูุฏ
st.subheader("โ๏ธ ูุฑุงุด ููุฌูุฏ")
ุงูุชุฎุงุจ_ูุญุตูู = st.selectbox("ุงูุชุฎุงุจ ูุญุตูู ุจุฑุง ูุฑุงุด", df["ูุญุตูู"].tolist())
ุชุบุฑ_ููุฌูุฏ = st.number_input("ุชุนุฏุงุฏ ุจุฑุง ุงุถุงูู/ฺฉู ฺฉุฑุฏู (ุนุฏุฏ ููู ุจุฑุง ฺฉุงูุด)", value=0)

if st.button("ุจุฑูุฒุฑุณุงู ููุฌูุฏ"):
    ุจุฑูุฒุฑุณุงู_ููุฌูุฏ(ุงูุชุฎุงุจ_ูุญุตูู, ุชุบุฑ_ููุฌูุฏ)
    st.success(f"โ ููุฌูุฏ ุจุฑุง {ุงูุชุฎุงุจ_ูุญุตูู} ุจูโุฑูุฒ ุดุฏ!")
    st.rerun()  # ุงุตูุงุญโุดุฏู