import pandas as pd
import numpy as np

# داده‌های بزرگ‌تر با ۲۰ محصول مختلف
data = {
    "محصول": [
        "لپ‌تاپ", "ماوس", "کیبورد", "مانیتور", "پرینتر", "تبلت", "هدفون", "وب‌کم",
        "چراغ رومیزی", "فلش USB", "هارد اکسترنال", "گوشی هوشمند", "ماوس گیمینگ", "کیبورد مکانیکی",
        "روتر بی‌سیم", "ساعت هوشمند", "کارت گرافیک", "هدست VR", "سیستم صوتی", "پاوربانک"
    ],
    "کد کالا": [
        "LP1001", "MS2001", "KB3001", "MN4001", "PR5001", "TB6001", "HP7001", "WC8001",
        "DL9001", "UD10001", "HD11001", "SP12001", "GM13001", "MK14001", "WR15001", "SW16001",
        "GC17001", "VR18001", "SP19001", "PB20001"
    ],
    "دسته‌بندی": [
        "الکترونیک", "لوازم جانبی", "لوازم جانبی", "الکترونیک", "اداری", "الکترونیک", "لوازم جانبی",
        "لوازم جانبی", "اداری", "ذخیره‌سازی", "ذخیره‌سازی", "الکترونیک", "گیمینگ", "گیمینگ", "شبکه",
        "پوشیدنی", "گیمینگ", "گیمینگ", "صوتی", "برق"
    ],
    "موجودی": np.random.randint(2, 50, size=20),  # سطح موجودی تصادفی
    "حداقل موجودی": np.random.randint(5, 20, size=20),  # حداقل مقدار سفارش مجدد
    "موجودی ورودی": np.random.randint(0, 10, size=20),
    "موجودی خروجی": np.random.randint(0, 10, size=20),
}

df = pd.DataFrame(data)

# محاسبه وضعیت موجودی
df["موجودی پیش‌بینی‌شده"] = df["موجودی"] + df["موجودی ورودی"] - df["موجودی خروجی"]
df["وضعیت موجودی"] = np.where(df["موجودی پیش‌بینی‌شده"] < df["حداقل موجودی"], "موجودی کم", "موجودی کافی")

# تابع دریافت محصولات با موجودی کم
def محصولات_با_موجودی_کم():
    return df[df["وضعیت موجودی"] == "موجودی کم"]

# تابع دریافت پیشنهادات سفارش مجدد
def پیشنهادات_سفارش():
    کمبود = محصولات_با_موجودی_کم()
    if کمبود.empty:
        return pd.DataFrame(columns=["محصول", "کد کالا", "تعداد پیشنهادی برای سفارش"])
    
    کمبود["تعداد پیشنهادی برای سفارش"] = کمبود["حداقل موجودی"] - کمبود["موجودی پیش‌بینی‌شده"]
    return کمبود[["محصول", "کد کالا", "تعداد پیشنهادی برای سفارش"]]

# تابع بروزرسانی موجودی
def بروزرسانی_موجودی(نام_محصول, مقدار_تغییر):
    global df
    df.loc[df["محصول"] == نام_محصول, "موجودی"] += مقدار_تغییر
    df["موجودی پیش‌بینی‌شده"] = df["موجودی"] + df["موجودی ورودی"] - df["موجودی خروجی"]
    df["وضعیت موجودی"] = np.where(df["موجودی پیش‌بینی‌شده"] < df["حداقل موجودی"], "موجودی کم", "موجودی کافی")